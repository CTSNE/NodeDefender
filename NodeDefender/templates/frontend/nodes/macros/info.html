{% macro NodeInfo(node) %}
{% from "frontend/macros/data/node/power.html" import Current as CurrentPower %}
{% from "frontend/macros/data/node/heat.html" import Current as CurrentHeat %}
<div class="row" style="height: 50%;">
	<div class="col-lg-4 textCenter">
		<a href="#">
			<i class="fa fa-unlock fa-2x" aria-hidden="true"></i>
			<p><strong>Unlocked</strong></p>
		</a>
	</div>
	<div class="col-lg-4 textCenter">
		<a href="#">
			<h3 style="margin: 0;">0</h3>
			<p><strong>Issues</strong></p>
		</a>
	</div>
	<div class="col-lg-4 textCenter">
		<a href="#">
			<i class="fa fa-book fa-2x" aria-hidden="true"></i>
			<p><strong>Notifications</strong></p>
		</a>
	</div>
</div>
<div class="row" style="height: 50%;">
	<div class="col-lg-6">
		{{ CurrentPower(node) }}
	</div>
	<div class="col-lg-6">
		{{ CurrentHeat(node) }}
	</div>
</div>
{% endmacro %}

{% macro iCPEInfo(iCPE) %}
<div class="row" style="height: 50%">
	<a href="#" class="col-lg-4 textCenter" data-toggle="tooltip" title="Update known Z-Wave devices">
		<i class="fa fa-refresh fa-2x" aria-hidden="true"></i>
		<p><strong>Update</strong></p>
	</a>
	<a href="#" class="col-lg-4 textCenter" data-toggle="tooltip" title="Include Z-Wave device">
		<i class="fa fa-sign-in fa-2x" aria-hidden="true"></i>
		<p><strong>Include</strong></p>
	</a>
	<a href="#" class="col-lg-4 textCenter" data-toggle="tooltip" title="Exclude Z-Wave device">
		<i class="fa fa-sign-out fa-2x" aria-hidden="true"></i>
		<p><strong>Exclude</strong></p>
	</a>
</div>
<div class="row" style="height: 50%">
	<div class="col-lg-6">
		<p><strong>Connection</strong></p>
		<p class="inline">Type: </p> 
		<p class="inline" id="connectionType">-</p>
		<br>
		<p class="inline">IP: </p> 
		<p class="inline" id="connectionAddr">-</p>
	</div>
	<div class="col-lg-6">
		<p><strong>Power</strong></p>
		<p class="inline">Source: </p> 
		<p class="inline" id="powerSource">-</p>
		<br>
		<p class="inline">Battery Level: </p> 
		<p class="inline" id="powerLevel">-</p>
	</div>
</div>
<script>
$(document).ready(function() {
	iCPE = "{{iCPE.macaddr}}";
	updateButton = $('#update-icpe');
	includeButton = $('#include-icpe');
	excludeButton = $('#exclude-icpe');

	iCPESocket.on('connection', function(conn) {
		document.getElementById('connectionType').innerHTML = conn.type;
		document.getElementById('connectionAddr').innerHTML = conn.address;
	});
	iCPESocket.on('power', function(power) {
		document.getElementById('powerSource').innerHTML = power.source;
		document.getElementById('powerLevel').innerHTML = power.battery;
	});

	iCPESocket.emit('connection', {'iCPE' : iCPE});
	iCPESocket.emit('power', {'iCPE' : iCPE});
	
	updateButton.click(function() {
		iCPESocket('updateSensors', {'iCPE' : iCPE});
	});
	includeButton.click(function() {
		iCPESocket('includeSensor', {'iCPE' : iCPE});
	});
	excludeButton.click(function() {
		iCPESocket('excludeSensor', {'iCPE' : iCPE});
	});
});
</script>
{% endmacro %}

{% macro AddiCPE(iCPE) %}
{% from "frontend/macros/icpe.html" import SelectiCPE %}
<div class="row">
	<div class="col-lg-12">
		<a href="#" style="display: inline-block; width: 100%; text-align: center;" data-toggle="modal" data-target="#AddiCPEModal">
			<i class="fa fa-4x fa-plus-square-o" aria-hidden="true"></i>
		</a>
	</div>
	<div class="col-lg-12" style="text-align: center">
		<h3>Add iCPE Connection</h3>
	</div>
</div>
<div class="modal fade" id="AddiCPEModal" role="dialog">
	<div class="modal-dialog">
		<div class="modal-content">
			<div class="modal-header">
				<button type="button" class="close" data-dismiss="modal">&times;</button>
				<h2 class="modal-title">Add iCPE Connection</h2>
			</div>
			<div class="modal-body">
				<div class="row">
					{{ SelectiCPE(current_user) }}
				</div>
			</div>
			<div class="modal-footer">
				<button type="button" class="btn btn-success" id="AddiCPEButton">Add iCPE</button>
				<button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
			</div>
		</div>
	</div>
</div>
	<script>
$(document).ready(function() {
	node = "{{Node.name}}"
	function addiCPE() {
		if ($('addiCPEMac').text() != 'None') {
			console.log($('#addicpemac').text());
			nodeSocket.emit('addiCPE', node, $('#addicpemac').text());
			return true;
		} else {
		 toastr.error("Please choose iCPE");
			return false;
		}
	}
	document.getElementById("AddiCPEButton").addEventListener("click", addiCPE);
});
	</script>
{% endmacro %}
