{% macro ListGroups(groups = None) %}
<table class="table table-hover" id="grouptable">
	<thead>
		<tr>
			<th>Name</th>
			<th>Description</th>
			<th>Users</th>
			<th>Nodes</th>
		</tr>
	</thead>
	<tbody id="grouptbody">
		{% if groups %}
		{% for group in groups %}
		<tr>
			<td>
				<a href="{{url_for('AdminView.AdminGroup', name = serialize(group.name))}}">
				{{group.name}}
				</a>
			</td>
			<td>
				<a href="{{url_for('AdminView.AdminGroup', name = serialize(group.name))}}">
					{{group.description}}
				</a>
			</td>
			<td>
				<a href="{{url_for('AdminView.AdminGroup', name = serialize(group.name))}}">
				{{group.users|count}}
				</a>
			</td>
			<td>
				<a href="{{url_for('AdminView.AdminGroup', name = serialize(group.name))}}">
					{{group.nodes|count}}
				</a>
			</td>
		</tr>
		{% endfor %}
		{% endif %}
	</tbody>
</table>
	<script>
grouptbody = document.getElementById('grouptbody');
grouptable = document.getElementById('grouptable');
	function groupList(groups) {
		for (var i = 0; i < groups.length; i++) {
			groupSocket.emit('info', (groups[i]));
		}
	};

	function clearGroupList() {
		while (grouptable.length > 0)
			groupable.deleteRow(0);
	};

	groupSocket.on('info', function(group) {
		var newRow = grouptbody.insertRow(0);

		var nameCell = newRow.insertCell(0);
		var nameText = document.createTextNode(group.name);
		nameCell.appendChild(nameText);

		var descCell = newRow.insertCell(1);
		var descText = document.createTextNode(group.description);
		descCell.appendChild(descText);

		var onlineCell = newRow.insertCell(2);
		var onlineText = document.createTextNode(icpe.online);
		onlineCell.appendChild(onlineText);
	});
	</script>

{% endmacro %}

{% macro CreateGroup(Form) %}
{% from "macros/form.html" import render_field_with_errors, render_field %}
<form action="{{url_for('AdminView.AdminGroups')}}" method="POST" class="form-horizontal">
	{{ Form.csfr_token }}
	{{ Form.hidden_tag() }}
	{{ render_field_with_errors(Form.Name) }}
	{{ render_field_with_errors(Form.Description) }}
	{{ render_field_with_errors(Form.Email) }}
	{{ render_field(Form.Submit) }}
</form>
{% endmacro %}

{% macro GroupInfo(Group) %}
{% from "macros/info.html" import Field %}
<div class="row">
	{{Field('Name', Group.name)}}
	{{Field('Description', Group.description)}}
	{{Field('Street', Group.location.street)}}
	{{Field('City', Group.location.city)}}
	{{Field('Created', Group.created_on)}}
</div>
{% endmacro %}

{% macro SelectGroup(user) %}
<div class="form-group">
	<label for="sell">Avalible Groups: </label>
	<select class="form-control" id="GroupsList"></select>
</div>
<form class="form-horizontal">
	<div class="row">
		<div class="col-md-6">
			<p><strong>Name</strong></p>
		</div>
		<div class="col-md-6">
			<p id="Groupname">None</p>
		</div>
		<div class="col-md-6">
			<p><strong>Description</strong></p>
		</div>
		<div class="col-md-6">
			<p id="Groupdesc">None</p>
		</div>
		<div class="col-md-6">
			<p><strong>Users</strong></p>
		</div>
		<div class="col-md-6">
			<p id="Groupusers">None</p>
		</div>
		<div class="col-md-6">
			<p><strong>Nodes</strong></p>
		</div>
		<div class="col-md-6">
			<p id="Groupnodes">None</p>
		</div>
	</div>
</form>
<script>
$(document).ready(function() {
	groupSocket.emit('list', ('{{user.email}}'));

	groupSocket.on('list', function(groups) {
		var glength = groups.length;
		if (glength < 1) {
			return 
		}
		
		for (var i = 0; i < glength; i++) {
			$('#GroupsList').append('<option>'+  groups[i].name + '</option>');
		}
		groupSocket.emit('info', {'name' : groups[0].name});
	});

	groupSocket.on('info', function(group) {
		$('#Groupname').text(group.name);
		$('#Groupdesc').text(group.description);
		$('#Groupusers').text(group.users);
		$('#Groupnodes').text(group.nodes);
	});

	$('#GroupsList').change(function() {
		var name = $('#GroupsList option:selected').text();
		groupSocket.emit('info', {'name' : name});
	});

	function addToGroup() {
		groupname = $('#Groupname').text();
		groupSocket.emit('addToGroup', {'user' : '{{user.email}}', 'group' : groupname});
	}

	groupSocket.on('Reload', function() {
		window.location.reload();
	});
});
</script>

{% endmacro %}
