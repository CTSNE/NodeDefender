{% macro Info(user) %}
{% from "macros/info.html" import Field %}
{{Field("Firstname", user.firstname)}}
{{Field("Lastname", user.lastname)}}
{{Field("Email", user.email)}}
{% endmacro %}

{% macro Events(user) %}
<p>Events</p>
{% endmacro %}

{% macro AddGroup(User, GroupForm) %}
{% from "macros/form.html" import render_field_with_errors, render_submit %}
<div class="modal fade" id="AddGroup" role="dialog">
	<div class="modal-dialog">
		<div class="modal-content">
			<div class="modal-header">
				<button type="button" class="close" data-dismiss="modal">&times;</button>
				<h2 class="modal-title">User Settings</h2>
			</div>
			<div class="modal-body">
				<div class="form-group">
					<label for="sell">Avalible Groups: </label>
					<select class="form-control" id="GroupsList">
					</select>
				</div>
				<form action="{{url_for('AdminView.AdminUser', email = serialize(User.email))}}" method="post" class="form-horizontal">
					<div class="row">
						<div class="col-md-6">
							<p><strong>Name</strong></p>
						</div>
						<div class="col-md-6">
							<p id="Groupname">None</p>
						</div>
						<div class="col-md-6">
							<p><strong>Description</strong></p>
						</div>
						<div class="col-md-6">
							<p id="Groupdesc">None</p>
						</div>
						<div class="col-md-6">
							<p><strong>Users</strong></p>
						</div>
						<div class="col-md-6">
							<p id="Groupusers">None</p>
						</div>
						<div class="col-md-6">
							<p><strong>Nodes</strong></p>
						</div>
						<div class="col-md-6">
							<p id="Groupnodes">None</p>
						</div>
					</div>
				</form>
			</div>
			<div class="modal-footer">
				<button type="button" class="btn btn-primary" id="submitToGroup">Save changes</button>
			</div>
		</div>
	</div>
</div>
<script>
$(document).ready(function() {
	socket.emit('groups', {'user' : '{{User.email}}'});

	socket.on('groupsrsp', function(groups) {
		var glength = groups.length;
		if (glength < 1) {
			return 
		}
		
		for (var i = 0; i < glength; i++) {
			$('#GroupsList').append('<option>'+  groups[i] + '</option>');
		}
		socket.emit('groupInfoGet', {'name' : groups[0]});
	});

	socket.on('groupInfoRsp', function(group) {
		$('#Groupname').text(group.name);
		$('#Groupdesc').text(group.description);
		$('#Groupusers').text(group.users);
		$('#Groupnodes').text(group.nodes);
	});

	$('#GroupsList').change(function() {
		var name = $('#GroupsList option:selected').text();
		socket.emit('groupInfoGet', {'name' : name});
	});

	document.getElementById("submitToGroup").onclick = function() {addToGroup()};

	function addToGroup() {
		groupname = $('#Groupname').text();
		socket.emit('addToGroup', {'user' : '{{User.email}}', 'group' : groupname});
	}

	socket.on('Reload', function() {
		window.location.reload();
	});
});
</script>
{% endmacro %}

{% macro AdminSettings(User, Form, Form2) %}
{% from "macros/form.html" import render_field_with_errors, render_submit %}
<div class="modal fade" id="UserConfigure" role="dialog">
	<div class="modal-dialog">
		<div class="modal-content">	
			<div class="modal-header">
				<button type="button" class="close" data-dismiss="modal">&times;</button>
				<h2 class="modal-title">User Settings</h2>
			</div>
			<div class="modal-body">
				<form action="{{url_for('AdminView.AdminUser', email = serialize(User.email))}}" method="post" class="form-horizontal">
					{{ Form.csfr_token }}
					{{ Form.hidden_tag() }}
					{{render_field_with_errors(Form.Firstname, User.firstname)}}
					{{render_field_with_errors(Form.Lastname, User.lastname)}}
					{{render_field_with_errors(Form.Email, User.email)}}
			</div>
			<div class="modal-footer">
				<button type="button" class="btn btn-warning" id="resetPassword">Reset Password</button>
				<button type="submit" class="btn btn-primary">Save changes</button>
				</form>
			</div>
		</div>
	</div>
</div>
	<script>
$(document).ready(function() {
	document.getElementById("resetPassword").onclick = function() {
		adminSocket.emit('resetUserPassword', {'email' : '{{User.email}}'});
	};
});
	</script>
{% endmacro %}

{% macro ListUsers(users) %}
<table class="table table-hover">
	<thead>
		<tr>
			<th>Firstname</th>
			<th>Lastname</th>
			<th>Email</th>
		</tr>
	</thead>
	<tbody>
		{% for user in users %}
		<tr>
			<td>
				<a href="{{url_for('AdminView.AdminUser', email = serialize(user.email))}}">
				{{user.firstname}}
				</a>
			</td>
			<td>
				<a href="{{url_for('AdminView.AdminUser', email = serialize(user.email))}}">
					{{user.lastname}}
				</a>
			</td>
			<td>
				<a href="{{url_for('AdminView.AdminUser', email = serialize(user.email))}}">
				{{user.email}}
				</a>
			</td>
		</tr>
		{% endfor %}
	</tbody>
</table>
{% endmacro %}
