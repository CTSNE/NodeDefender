{% macro CreateUser() %}
{% from "macros/form.html" import render_manual %}
{% from "macros/info.html" import FieldID %}
{% from "macros/role.html" import select_role %}
{% from "macros/group.html" import SelectGroup %}
<div class="modal fade" id="CreateUser" role="dialog">
	<div class="modal-dialog">
		<div class="modal-content">
			<div class="modal-header">
				<button type="button" class="close" data-dismiss="modal">&times;</button>
				<h2 class="modal-title">Create User</h2>
				<div class="progress-bar" role="progressbar" aria-valuemin="0" aria-valuemax="100"></div>
			</div>
			<div class="modal-body">
				<div class="multiform-step">
					<div class="row">
						{{ render_manual('Firstname', 'userFirstname') }}
						{{ render_manual('Lastname', 'userLastname') }}
						{{ render_manual('Mail', 'userMail') }}
						{{ select_role() }}
					</div>
				</div>
				<div class="multiform-step">
					{{ SelectGroup(current_user) }}
				</div>
				<div class="multiform-step">
					<div class="row">
						{{ FieldID('Firstname', '-', 'submitFirstname') }}
						{{ FieldID('Lastname', '-', 'submitLastname') }}
						{{ FieldID('Mail', '-', 'submitMail') }}
						{{ FieldID('Role', '-', 'submitRole') }}
						{{ FieldID('Group', '-', 'submitGroup') }}
					</div>
				</div>
			</div>
			<div class="modal-footer">
				<button class="multibtn multiform-back btn btn-info">Back</button>
				<button class="multibtn multiform-next btn btn-info">Next</button>
				<button class="multibtn multiform-submit btn btn-success">Submit</button>
			</div>
		</div>
	</div>
</div>
	<script>
$(document).ready(function() {
	var userInfo = function()  {
		if ($('#userMail').val() == '') {
			toastr.error('Please enter Mail Address');
			return false;
		}
		if ($('#userFirstname').val() == '') {
			toastr.info('No firstname selected');
		}
		if ($('#userLastname').val() == '') {
			toastr.info('No lastname selected');
		}

		$('#submitFirstname').text($('#userFirstname').val());
		$('#submitLastname').text($('#userLastname').val());
		$('#submitMail').text($('#userMail').val());
		$('#submitRole').text($('#UserRole option:selected').text());
		return true;
	}
	var userGroup = function () {
		if ($('#GroupsList option:selected').text() == '') {
			toastr.info('No group selected');
			$('#submitGroup').text('');
		}
		else {
			$('#submitGroup').text($('#GroupsList option:selected').text());
		}
		return true;
	}
	var userSubmit = function() {
		var firstname = $('#submitFirstname').text();
		var lastname = $('#submitLastname').text();
		var mail = $('#submitMail').text();
		var role = $('#submitRole').text();
		var group = $('#submitGroup').text();
		adminSocket.emit('createUser', {'firstname' : firstname, 'lastname' : lastname, 'email' : mail, 'role' : role, 'group' : group});
		return true;
	}
	initMultistep(userInfo, userGroup, userSubmit);
});
	</script>
<script src="/static/js/multistep.js"></script>
{% endmacro %}
